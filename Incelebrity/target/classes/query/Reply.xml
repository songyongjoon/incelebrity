<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.spring.client.reviewReply.dao.ReviewReplyDao">
   <!-- 댓글 전체 조회(해당 게시물번호에 대해) -->
   <select id="reviewReplyList" parameterType="reply" resultType="reply">
      select review_reply_no, review_no, review_reply_content, review_reply_name
      ,to_char(review_reply_writeday, 'YYYY-MM-DD') as review_reply_writeday
      from review_reply 
      where review_no = #{review_no} 
      order by review_reply_no desc
   </select>
   
   <!-- 댓글 등록 -->
   <insert id="replyInsert" parameterType="reply">
      /* Reply - replyInsert */
      <selectKey keyProperty="review_reply_no" resultType="int" order="BEFORE">
         select review_reply_seq.nextval from dual      
      </selectKey>
         insert into review_reply(
            review_reply_no, review_no, review_reply_name, review_reply_content, review_reply_writeday
         )
         values(
            #{review_reply_no}, #{review_no}, #{review_reply_name}, #{review_reply_content}, sysdate
         )
   </insert>
   
   
   <!-- 해당번호 댓글 정보 조회 -->
   <select id="replySelect" parameterType="int" resultType="reply">
      select r_num, b_num, r_name, r_content, r_date
      from spring_reply
      where r_num = #{r_num}
   </select>
   
   <!-- 댓글 수정 -->
   <update id="replyUpdate" parameterType="reply">
      /*Reply - replyUpdate*/
      update review_reply
      set review_reply_content = #{review_reply_content}
      ,review_reply_writeday = sysdate
      where review_reply_no = #{review_reply_no}
   </update>
   
   <!-- 댓글 삭제 -->
   <delete id="replyDelete" parameterType="reply">
         /*Reply - replyDelete*/
         delete from review_reply where review_reply_no = #{review_reply_no}
   </delete>
   
   <!-- 댓글 개수 구하기 -->
   <select id="replyCnt" parameterType="int" resultType="int">
   	/*	reply - replyCnt	*/
   	select count(r_num)from spring_reply where b_num = #{b_num}
   </select>
</mapper>